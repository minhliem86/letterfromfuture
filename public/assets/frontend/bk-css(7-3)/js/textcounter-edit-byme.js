!function(a){a.textcounter=function(b,c){var d=this;d.$el=a(b),d.el=b,d.$el.data("textcounter",d),d.init=function(){d.options=a.extend({},a.textcounter.defaultOptions,c);var b=d.options.countDown?d.options.countDownText:d.options.counterText,e=d.options.countDown?d.options.max:0,f=a("<div/>").html(b.replace("%d",'<span class="'+d.options.textCountClass+'">'+e+"</span>")).contents();d.$container=a("<"+d.options.countContainerElement+"/>").addClass(d.options.countContainerClass).append(f),d.$text_counter=d.$container.find("span"),d.$el.parent().next().append(d.$container),d.$el.bind("keyup.textcounter click.textcounter blur.textcounter focus.textcounter change.textcounter paste.textcounter",d.checkLimits).trigger("click.textcounter"),d.options.init(d.el)},d.checkLimits=function(b){var c=d.$el,e=(d.$container,c.val()),f=0,g=0,h=void 0!==b.originalEvent;if(!a.isEmptyObject(e))if("word"==d.options.type)f=e.trim().replace(/\s+/gi," ").split(" ").length;else{if(d.options.twoCharCarriageReturn){var i=e.match(/(\r\n|\n|\r)/g),j=0;null!==i&&(j=i.length)}if(f=d.options.countSpaces?e.replace(/[^\S\n|\r|\r\n]/g," ").length:e.replace(/\s/g,"").length,d.options.countExtendedCharacters){var k=e.match(/[^\x00-\xff]/gi);f=null==k?e.length:e.length+k.length}d.options.twoCharCarriageReturn&&(f+=j)}if("auto"==d.options.max){var l=d.$el.attr("maxlength");"undefined"!=typeof l&&l!==!1?d.options.max=l:d.$container.text("error: [maxlength] attribute not set")}if(g=d.options.countDown?d.options.max-f:f,d.setCount(g),d.options.min>0&&h&&(f<d.options.min?(d.setErrors("min"),d.options.minunder(d.el)):f>=d.options.min&&(d.options.mincount(d.el),d.clearErrors("min"))),d.options.max!==-1)if(f>=d.options.max&&0!=d.options.max)if(d.options.maxcount(d.el),d.options.stopInputAtMaximum){var m="";if("word"==d.options.type)for(var n=e.split(/[^\S\n]/g),o=0;o<n.length&&!(o>=d.options.max-1);)void 0!==n[o]&&(m+=n[o]+" ",o++);else if(d.options.countSpaces)m=e.substring(0,d.options.max);else for(var p=e.split(""),q=p.length,r=0,o=0;r<d.options.max&&o<q;)" "!==p[o]&&r++,m+=p[o++];c.val(m.trim()),g=d.options.countDown?0:d.options.max,d.setCount(g)}else d.setErrors("max");else d.options.maxunder(d.el),d.clearErrors("max")},d.setCount=function(a){d.$text_counter.text(a)},d.setErrors=function(a){var b=d.$el,c=d.$container,e="";if(b.addClass(d.options.inputErrorClass),c.addClass(d.options.counterErrorClass),d.options.displayErrorText){switch(a){case"min":e=d.options.minimumErrorText;break;case"max":e=d.options.maximumErrorText}c.children(".error-text-"+a).length||c.append("<"+d.options.errorTextElement+' class="error-text error-text-'+a+'">'+e+"</"+d.options.errorTextElement+">")}},d.clearErrors=function(a){var b=d.$el,c=d.$container;c.children(".error-text-"+a).remove(),0==c.children(".error-text").length&&(b.removeClass(d.options.inputErrorClass),c.removeClass(d.options.counterErrorClass))},d.init()},a.textcounter.defaultOptions={type:"character",min:0,max:200,countContainerElement:"div",countContainerClass:"text-count-wrapper",textCountClass:"text-count",inputErrorClass:"error",counterErrorClass:"error",counterText:"Total Count: %d",errorTextElement:"div",minimumErrorText:"Minimum not met",maximumErrorText:"Maximum exceeded",displayErrorText:!0,stopInputAtMaximum:!0,countSpaces:!1,countDown:!1,countDownText:"Remaining: %d",countExtendedCharacters:!1,twoCharCarriageReturn:!1,maxunder:function(a){},minunder:function(a){},maxcount:function(a){},mincount:function(a){},init:function(a){}},a.fn.textcounter=function(b){return this.each(function(){new a.textcounter(this,b)})}}(jQuery);